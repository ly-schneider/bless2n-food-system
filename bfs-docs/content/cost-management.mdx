---
title: Kostenmanagement
description: Budgets, Scaling, Cosmos RU/s, Log‑Retention und monatliche Checks
---

# Budgets & Alerts

- Budgets: Pro Resource Group (z. B. Staging, Production) via `modules/budget`.
- Action Groups: E‑Mail‑Empfänger via Env Vars (`alert_emails`) und `modules/action_group`.
- Monitoring: Metrik‑basierte Alerts für Container Apps (5xx, CPU/Memory) und Cosmos RU‑Throttling.

---

# Scale‑to‑Zero & Scaling Rules

- Min Replicas = 0 (Frontend & Backend); skaliert bedarfsgerecht hoch.
- Trigger:
  - HTTP Concurrent Requests (z. B. 20/40)
  - CPU‑Prozentsatz (z. B. 75%/80%)
  - Memory‑Prozentsatz (Backend ggf. zusätzlich in Prod)
- Anpassung: Variablen im Env Root ändern → Terraform apply; Cold‑Start vs. Kosten abwägen.

---

# Cosmos Kosten

- RU/s Provisioning: Konservativ starten (z. B. 400 RU/s) und Hotspots beobachten.
- Serverless vs. Provisioned: Provisioned für gleichmäßigen Traffic; Serverless bei stark schwankend/gering.
- Partitionierung & Indizes: Keine Queries ohne passende Indizes; Fan‑out Scans vermeiden.

---

# Logs & Retention

- LAW Retention: Standard 30 Tage; je Umgebung anpassen.
- Metrics vs. Logs: Alerts auf Metrics; Logs zur Analyse. Bei hohem Volumen Log‑Sampling erwägen.

---

# Monatliche Review‑Checkliste

- Kosten pro Service: ACR Egress, Container Apps Runtime, Cosmos RU/s, LAW Ingestion.
- Anomalien: Mit Deploys oder Traffic‑Ereignissen korrelieren.
- Scale Settings: min=0, sinnvolles max; Schwellen prüfen.
- RU‑Anpassungen: Cosmos RU/s nach Headroom und Throttling justieren.
