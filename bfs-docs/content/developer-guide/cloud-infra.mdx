---
title: Cloud Infra (Terraform)
description: Module, Environment Roots, Container Apps Config, Key Vault und Digests
---

# Module & Umgebungen

- Module unter `modules/`: `stack`, `containerapp`, `containerapps_env`, `cosmos_mongo`, `security`, `alerts`, `rg`, `network`, `diagnostic_setting`, `observability`, `budget`, `action_group`.
- Envs unter `envs/<env>`: Root‑Module, die `modules/stack` parametrisieren.

# Container Apps

- Image Auswahl: Bevorzugt immutable Digests (`frontend_digest`, `backend_digest`) aus CI; Fallback auf Tag + `revision_suffix`.
- Scaling Rules pro App; Health Checks und Liveness; 0–N Replicas (Scale‑to‑Zero).
- Secrets/Envs: `secrets` für Werte und `key_vault_secrets` für KV‑Namen; zu versionless IDs aufgelöst.

# Security

- Key Vault für Secrets; Role Assignments mit KV Secrets User; optional KV Admins.
- Alerts auf Container Apps‑Metriken; Diagnostic Settings für KV.

# ACR & CI

- Images in ACR/GHCR Build & Push; Login via OIDC; Registry `${ACR_NAME}.azurecr.io`.
- Deployments verwenden Image Digests und propagieren sie an die Apps.
