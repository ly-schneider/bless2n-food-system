---
title: Kostenmanagement
description: Budgets, Scaling, Datenbank, Log-Retention und monatliche Checks
---

# Budgets & Alerts

- Budgets: Pro Resource Group (z. B. Staging, Production) via `modules/budget`.
- Action Groups: E-Mail-Empfänger via Env Vars (`alert_emails`) und `modules/action_group`.
- Monitoring: Metrik-basierte Alerts für Container Apps (5xx, CPU/Memory).

---

# Scale-to-Zero & Scaling Rules

- Min Replicas = 0 (Frontend & Backend); skaliert bedarfsgerecht hoch.
- Trigger:
  - HTTP Concurrent Requests (z. B. 20/40)
  - CPU-Prozentsatz (z. B. 75%/80%)
  - Memory-Prozentsatz (Backend ggf. zusätzlich in Prod)
- Anpassung: Variablen im Env Root ändern -> Terraform apply; Cold-Start vs. Kosten abwägen.

---

# Datenbank Kosten

- PostgreSQL: Kosten je nach Anbieter (z. B. NeonDB Free Tier, Azure Database for PostgreSQL).
- Verbindungen: Connection Pooling beachten; `MaxConns` und `MinConns` im Backend konfiguriert.
- Migrationen: Flyway für Schema-Verwaltung; keine manuellen DDL-Änderungen.

---

# Logs & Retention

- LAW Retention: Standard 30 Tage; je Umgebung anpassen.
- Metrics vs. Logs: Alerts auf Metrics; Logs zur Analyse. Bei hohem Volumen Log-Sampling erwägen.

---

# Monatliche Review-Checkliste

- Kosten pro Service: ACR Egress, Container Apps Runtime, PostgreSQL, LAW Ingestion.
- Anomalien: Mit Deploys oder Traffic-Ereignissen korrelieren.
- Scale Settings: min=0, sinnvolles max; Schwellen prüfen.
- Datenbank: Verbindungsauslastung und Abfrage-Performance prüfen.
