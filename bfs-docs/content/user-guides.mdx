---
title: User Guides
description: Häufige Aufgaben für Kund:innen und POS‑Personal
---

# Online Essen bestellen

Voraussetzungen:

- Zugriff auf den Web‑Shop (`/`), Stripe TWINT aktiviert, Backend erreichbar.

Schritte:

- Anmelden (optional):
  - OTP: Code anfordern via `/v1/auth/otp/request`, verifizieren via `/v1/auth/otp/verify` (über die UI gesteuert).
  - Google: Authorization Code + PKCE; der Austausch läuft im Frontend via `/v1/auth/google/code`.
- Artikel hinzufügen: Produkte/Menus wählen; Menus erlauben Slot‑Auswahlen.
- Checkout (TWINT):
  - Frontend ruft `/v1/payments/create-intent` mit Items auf und erhält `clientSecret` und vorläufige `orderId`.
  - Stripe Elements zeigt den TWINT‑Flow; mobil in der TWINT‑App, am Desktop ggf. QR.
  - Nach Zahlung fragt die Return‑Seite `/v1/payments/{id}` ab; der Backend‑Webhook finalisiert die Bestellung.
- Bestellungen ansehen: Angemeldet → `/v1/orders` (eigene Bestellungen). Öffentlich: `/v1/orders/{id}` (reduzierte Felder).

Hinweise:

- Währung: CHF; nur TWINT. E‑Mail‑Belege können vor Bestätigung via `/v1/payments/attach-email` gesetzt werden.

---

# POS Verkauf im Laden

Voraussetzungen:

- Android POS App installiert und bei SumUp angemeldet; Drucker gekoppelt.
- Web‑POS erreichbar (`/pos`) und in der App konfiguriert (`POS_URL`).

Ablauf:

- Android POS App öffnen: Lädt die `/pos`‑Seite in einer WebView.
- Warenkorb: Artikel über die POS‑UI hinzufügen.
- Zahlung annehmen:
  - Cash: Web‑POS postet nach `/api/v1/pos/orders`, danach `/api/v1/pos/orders/{id}/pay-cash` mit Betrag; druckt Beleg.
  - Card (SumUp): Web‑POS ruft `window.PosBridge.payWithCard({ amountCents, currency: 'CHF', reference })` auf. Der Android SDK‑Flow liefert `bfs:sumup:result`; danach Order erstellen und `pay-card` mit `{ processor: 'sumup', transactionId, status }`.
- Beleg drucken: Web‑POS sendet `window.PosBridge.print(json)`; Android druckt via ESC/POS oder Raster und sendet `bfs:print:result`.

Fähigkeiten:

- `window.PosBridge` wird zur Laufzeit erkannt; die UI passt sich an, wenn nicht verfügbar (z. B. im Browser ohne native Bridge).
- Abhol‑QR kann via `/v1/orders/{id}/pickup-qr` gedruckt werden.

---

# Troubleshooting (User)

- Payment failed:
  - Netzwerk prüfen; TWINT in‑App erneut versuchen. Team kann Zahlung im Stripe Dashboard prüfen und Orders abgleichen.
  - `/v1/payments/{id}` auf Status prüfen; Webhook kann kurz verzögert sein.
- Order not found:
  - Bestätigungslink oder öffentliche Seite `/orders/{id}` nutzen; falls angemeldet, mit demselben Account einloggen.
  - Im Admin → Orders kann nach Bestellungen gesucht werden.
- Anmeldung nicht möglich:
  - OTP: Spam prüfen; richtige E‑Mail? Google: Redirect URI muss zum konfigurierten Client in der Cloud passen.
- Probleme mit POS‑Seite:
  - Android: `POS_URL`, SumUp‑Login, Bluetooth‑Berechtigungen für Druck prüfen.
  - Ohne `PosBridge` läuft es wohl im normalen Browser; für volle Funktionen Android App nutzen.
